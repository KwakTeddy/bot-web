<script>
  function changeFunc(selectBox) {
    document.getElementById("year").style.display = "none";
    document.getElementById("ym").style.display = "none";
    switch (selectBox.selectedIndex) {
      case 1:
        document.getElementById("year").style.display = "inline";
        break;
      case 2:
        document.getElementById("ym").style.display = "inline";
        break;
    }
  }

</script>
<header class="page-header">
  <h2>대화 실패 분석</h2>

  <div class="right-wrapper pull-right">
    <a class="sidebar-right-toggle" data-open="sidebar-right"><i class="fa fa-chevron-left"></i></a>
  </div>
</header>

<!-- start: page -->
<section class="panel" ng-controller="AnalyticsListController" ng-init="find_dialog_failure()">
  <header class="panel-heading" style="padding:3px">
    <form name="form" novalidate="novalidate">
      <table width="100%"><tr><td>
        <h2 class="panel-title">&nbsp;</h2>
      </td><td align="right">
        <select name="kind" ng-model="kind"  onchange="changeFunc(this)">
          <option selected="selected" value="all">전체</option>
          <option value="year">연도별</option>
          <option value="month">월별</option>
        </select>
        <input type="number" id="year" ng-model="year" min="1999" max="2100" value='2017' style="display:none">
        <input type="month" id="ym" ng-model="ym" style="display:none" value="2017-03">
        <button class="btn btn-primary" ng-click="find_dialog_failure()">검색</button>
      </td></tr></table>
    </form>
  </header>

  <div class="panel-body">
    <table datatable="ng" id="dt" dt-options="vm.dtOptions" class="table table-bordered table-striped mb-none">
      <thead>
      <tr>
        <th class="text-center">대화</th>
        <th class="text-center">실패빈도</th>
        <th class="text-center">관리</th>
      </tr>
      </thead>
      <tbody>
      <tr ng-repeat="dialogUsage in dialogFailure">
        <td class="text-center">{{dialogUsage._id.dialog}}</td>
        <td class="text-center">{{dialogUsage.count}}</td>
        <td class="text-center">
          <button class="modal-with-form2 btn btn-default btn-sm btn-block" ng-click="findChildren(dialogUsage._id.preDialogId, dialogUsage._id.dialog)">대화수정</button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="test-body">
    <a class="modal-with-form btn btn-default" style="display:none" href="#modalForm">Open Form</a>

    <!-- Modal Form -->
    <div id="modalForm" class="modal-block modal-block-primary mfp-hide">
      <section class="panel">
        <header class="panel-heading">
          <h2 class="panel-title">&nbsp;</h2>
        </header>
        <form name="dialogForm" class="form-horizontal" novalidate="novalidate">
        <div class="panel-body">
          <div class="form-group">
            <label class="col-sm-3 control-label">다이얼로그 선택</label>
            <div class="col-sm-9">
              <select name="kind" ng-model="selected" ng-options="d.name for d in dialogs">
                <!--<option ng-repeat="d in dialogs" ng-selected="selected == d.idx" value="{{d.idx}}">{{d.name}}</option>-->
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label">질문 <span class="required" aria-required="true">*</span></label>
            <div class="col-sm-9">
              <div class="input-group input-group-icon" ng-repeat="input in selected.inputs">
                <input type="text" class="form-control mb-xs" ng-model="input.str" placeholder="질문을 입력해주세요">
              </div>
              <button type="button" ng-click="addInput()" class="mb-xs mr-xs btn btn-sm btn-info"><i class="glyphicon glyphicon-plus"></i> 질문추가</button>
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-3 control-label">답변 <span class="required" aria-required="true">*</span></label>
            <div class="col-sm-9">
              <div class="input-group input-group-icon" ng-repeat="output in selected.outputs">
                <input type="text" id="output" name="output" ng-model="output.str" class="form-control valid mb-xs" placeholder="답변을 입력해주세요" required="" aria-required="true" aria-invalid="false">
              </div>
              <button type="button" ng-click="addOutput()" class="mb-xs mr-xs btn btn-sm btn-info"><i class="glyphicon glyphicon-plus"></i> 답변추가</button>
            </div>
          </div>
        </div>
        <footer class="panel-footer">
          <div class="row">
            <div class="col-md-12 text-right">
              <button class="btn btn-primary modal-confirm" ng-click="update(dialogForm.$valid)" >저장</button>
              <button class="btn btn-default modal-dismiss">취소</button>
            </div>
          </div>
        </footer>
        </form>
      </section>
    </div>
  </div>
</section>

<script src="/vendor/pnotify/pnotify.custom.js"></script>
<script src="/js/ui-elements/examples.modals.js"></script>

