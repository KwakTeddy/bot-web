<script type="text/template" id="dialogLearningRowTemplate">
<div class="dialog-learning-development-content-row">
    <p class="new-dialog-title">{{lan('New Dialog') }}</p>
    <form ng-submit="addDialog($event);">
        <div class="topic-area">
            <div>
                <div>
                    <p>Topic 1</p>
                    <div class="select-wrapper">
                        <select class="data-select" tabindex="-1"></select>
                    </div>
                </div>
                <div>
                    <p>Topic 2</p>
                    <div class="select-wrapper">
                        <select class="data-select" tabindex="-1"></select>
                    </div>
                </div>
                <div>
                    <p>Topic 3</p>
                    <div class="select-wrapper">
                        <select class="data-select" tabindex="-1"></select>
                    </div>
                </div>
            </div>
        </div>
        <div class="question-area">
            <textarea type="text" class="data-input" ng-keydown="inputKeydown($event);" ng-required="true"></textarea>
            <span class="plus-button" ng-click="addInput($event);"></span>
        </div>
        <div class="answer-area">
            <textarea type="text" class="data-input" ng-keydown="inputKeydown($event);" ng-required="true"></textarea>
            <span class="plus-button" ng-click="addInput($event);"></span>
        </div>
        <div class="functions-area" style="margin-top: 5px;">
            <button class="blue-button" style="width: 90px;"> <img src="/modules/playchat/working-ground/common/client/imgs/add.png">{{lan(' Add') }}</button>
            <img src="/modules/playchat/working-ground/dialog-set/client/imgs/editing.gif" class="editing-img" style="{{lan('display: none;') }}">
            <img src="/modules/playchat/working-ground/dialog-set/client/imgs/saving.png" class="saving-img" style="{{lan('display: none;') }}">
            <img src="/modules/playchat/working-ground/dialog-set/client/imgs/saved.png" class="saved-img" style="{{lan('display: none;') }}">
            <img src="/modules/playchat/working-ground/common/client/imgs/delete_dialog.png" class="delete-img" style="{{lan('display: none;') }}">
        </div>
    </form>
</div>
</script>

<div ng-controller="DialogLearningDevelopmentController" style="min-width: 800px;">
    <div class="upSide">
        <form class="inline-block">
            <input id="search" name="search" type="search" class="search" ng-keydown="search($event);">
        </form>
        <!--<div class="funtionbtn1">-->
            <!--<a href="#">-->
                <!--<img src="modules/playchat/working-ground/common/client/imgs/import.png">-->
                <!--<span ng-click="modal.importModal.open();">{{lan('Import') }}</span>-->
                <!--<img src="modules/playchat/working-ground/common/client/imgs/Q.png">-->
            <!--</a>-->
        <!--</div>-->
    </div>
    <div class="tab01">
        <ul class="tabs1">
            <li class="mini" ng-click="openDialogset();"><a href="#"><img src="modules/playchat/working-ground/common/client/imgs/plus.png"></a></li>
        </ul>
    </div>
    <div class="dialog-learning-development-title">
        <span ng-class="topicOpened ? 'topicopen-topic' : 'topicclose-topic'">{{lan('Topic') }}</span>
        <span ng-class="topicOpened ? 'topicopen-question' : 'topicclose-question'">{{lan('Question') }}</span>
        <span ng-class="topicOpened ? 'topicopen-answer' : 'topicclose-answer'">{{lan('Answer') }}</span>
        <div class="topicswitch">
            <span style="font-size: 12px;font-weight: 600;line-height: 23px;margin-right: 7px;">{{lan('Topic') }}</span>
            <div class="slide inline-block" style="vertical-align: top;">
                <input type="checkbox" id="topicOpen" ng-model="topicOpened" />
                <label for="topicOpen"></label>
            </div>
        </div>
    </div>
    <div class="dialog-learning-development-content">
        <div class="dialog-learning-development-content-row">
            <p class="new-dialog-title">{{lan('New Dialog') }}</p>
            <form ng-submit="addDialog($event);">
                <div class="topic-area">
                    <div>
                        <div>
                            <p>Topic 1</p>
                            <div class="select-wrapper">
                                <select class="data-select" tabindex="-1"></select>
                            </div>
                        </div>
                        <div>
                            <p>Topic 2</p>
                            <div class="select-wrapper">
                                <select class="data-select" tabindex="-1"></select>
                            </div>
                        </div>
                        <div>
                            <p>Topic 3</p>
                            <div class="select-wrapper">
                                <select class="data-select" tabindex="-1"></select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="question-area">
                    <textarea type="text" class="data-input" ng-required="true" ng-keydown="inputKeydownElement($event, 'inputRaw');"></textarea>
                    <span class="plus-button" ng-click="addInputElement($event);"></span>
                </div>
                <div class="answer-area">
                    <textarea type="text" class="data-input" ng-required="true" ng-keydown="inputKeydownElement($event, 'output');"></textarea>
                    <span class="plus-button" ng-click="addInputElement($event);"></span>
                </div>
                <div class="functions-area" style="margin-top: 5px;">
                    <button class="blue-button"style="width: 90px;"> <img src="/modules/playchat/working-ground/common/client/imgs/add.png"> {{lan('Add') }}</button>
                    <img src="/modules/playchat/working-ground/dialog-set/client/imgs/editing.gif" class="editing-img" style="display: none;">
                    <img src="/modules/playchat/working-ground/dialog-set/client/imgs/saving.png" class="saving-img" style="display: none;">
                    <img src="/modules/playchat/working-ground/dialog-set/client/imgs/saved.png" class="saved-img" style="display: none;">
                    <img src="/modules/playchat/working-ground/common/client/imgs/delete_dialog.png" class="delete-img" style="display: none;">
                </div>
            </form>
        </div>
        <div class="dialog-learning-development-content-row" ng-repeat="dialog in dialogs" data-id="{{ dialog._id }}">
            <form ng-submit="addDialog($event);" data-id="{{ dialog._id }}">
                <div class="topic-area">
                    <div>
                        <div>
                            <p>Topic 1</p>
                            <select class="data-select" tabindex="-1">
                                <option ng-if="dialog.context && dialog.context.parent && dialog.context.parent.parent">{{ dialog.context.parent.parent.name }}</option>
                            </select>
                        </div>
                        <div>
                            <p>Topic 2</p>
                            <select class="data-select" tabindex="-1">
                                <option ng-if="dialog.context && dialog.context.parent">{{ dialog.context.parent.name }}</option>
                            </select>
                        </div>
                        <div>
                            <p>Topic 3</p>
                            <select class="data-select" tabindex="-1">
                                <option ng-if="dialog.context">{{ dialog.context.name }}</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="question-area">
                    <div style="position: relative;" ng-repeat="input in dialog.inputRaw track by $index">
                        <textarea type="text" class="data-input" ng-keydown="inputKeydown($event, dialog, 'inputRaw', input);" ng-if="isArray(dialog.inputRaw);" ng-focus="checkModify($event);" ng-keyup="watchModified('input', $event)" ng-blur="saveModified('input', $event)">{{ input }}</textarea>
                        <img ng-if="$index > 0" src="/modules/playchat/working-ground/common/client/imgs/delete_lighter.png" class="delete-img" style="position: absolute; top: 5px; right: 5px;" ng-click="deleteInput(dialog.inputRaw, $index);">
                    </div>
                    <!--<textarea type="text" class="data-input" ng-keydown="inputKeydown($event, dialog, 'inputRaw');" ng-if="!isArray(dialog.inputRaw);" ng-focus="checkModify($event);" ng-keyup="watchModified('input', $event)" ng-blur="saveModified('input', $event)">vvv</textarea>-->
                    <span class="plus-button" ng-click="addInput($event, dialog, 'inputRaw');" ng-required="true"></span>
                </div>
                <div class="answer-area">
                    <div style="position: relative;" ng-repeat="output in dialog.output track by $index">
                        <textarea type="text" class="data-input" ng-keydown="inputKeydown($event, dialog, 'output', output);" ng-if="isArray(dialog.output);" ng-focus="checkModify($event);" ng-keyup="watchModified('output', $event)" ng-blur="saveModified('input', $event)">{{ output }}</textarea>
                        <img ng-if="$index > 0" src="/modules/playchat/working-ground/common/client/imgs/delete_lighter.png" class="delete-img" style="position: absolute; top: 5px; right: 5px;" ng-click="deleteInput(dialog.output, $index);">
                    </div>
                    <!--<textarea type="text" class="data-input" ng-keydown="inputKeydown($event, dialog, 'output');" ng-if="!isArray(dialog.output);" ng-focus="checkModify($event);" ng-keyup="watchModified('output', $event)" ng-blur="saveModified('input', $event)">{{ dialog.output }}</textarea>-->
                    <span class="plus-button" ng-click="addInput($event, dialog, 'output');" ng-required="true" ></span>
                </div>
                <div class="functions-area" style="margin-top: 5px;">
                    <img src="/modules/playchat/working-ground/dialog-set/client/imgs/editing.gif" class="editing-img" style="display: none;">
                    <img src="/modules/playchat/working-ground/dialog-set/client/imgs/saving.png" class="saving-img" style="display: none;">
                    <img src="/modules/playchat/working-ground/dialog-set/client/imgs/saved.png" class="saved-img" style="display: none;">
                    <img src="/modules/playchat/working-ground/common/client/imgs/delete_dialog.png" class="delete-img" ng-click="deleteDialog(dialog, $event);">
                </div>
            </form>
        </div>
    </div>
    <div style="text-align: center;">
        <img src="/modules/playchat/working-ground/dialog-set/client/imgs/editing.gif" class="more-progress" style="opacity: 0;">
    </div>

    <div class="modal-background open-modal" ng-show="openModal.isOpened">
        <div class="modal">
            <div>
                <h2 style="border-bottom: 1px solid #ddd; padding: 10px 0;">{{lan('Open Dialogset') }}</h2>
            </div>
            <div ng-show="!openModal.isCreate">
                <div style="padding: 30px 0;">
                    <div class="select-wrapper">
                        <select class="jumbo-select" style="font-size: 12px; width: 150px;" ng-change="createNewDialogset();" ng-model="openModal.selectedDialogset">
                            <option value="" disabled>{{lan('Choose Dialogset')}}</option>
                            <option value="create-new">{{lan('Add New')}}</option>
                            <option ng-repeat="dialogset in openModal.dialogsetList" value="{{ dialogset._id }}">{{ dialogset.title }}</option>
                        </select>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button type="button" class="default-button" ng-click="closeOpenModal();">{{lan('Close') }}</button>
                </div>
            </div>
            <form name="modalFormDefault" ng-submit="saveNewDialogset();" ng-show="openModal.isCreate">
                <div class="form-row">
                    <label class="required" style="width: 100%;">
                        <span class="form-title">{{lan('Title') }}</span>
                        <input type="text" placeholder="{{lan('Enter dialogset name')}}" name="title" ng-model="openModal.data.title" class="dialogset-title data-input" ng-required="true">
                    </label>
                </div>
                <div class="form-row">
                    <label style="width: 100%;">
                        <span>{{lan('Content') }}</span>
                        <textarea placeholder="내용을 입력해주세요" name="content" ng-model="openModal.data.content" class="data-input"></textarea>
                    </label>
                </div>
                <div class="tab-footer">
                    <button class="blue-button">{{lan('Save') }}</button>
                    <button type="button" class="default-button" ng-click="closeOpenModal();">{{lan('Close') }}</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-background management-modal" ng-show="modal.importModal.isOpened">
        <div class="modal">
            <form name="modalFormDefault" ng-submit="save(modal.importModal);">
                <div class="form-row">
                    <label class="required" style="width: 100%;">
                        <span class="form-title">{{lan('Title') }}</span>
                        <input type="text" placeholder="대화셋 이름을 입력해주세요" name="title" ng-model="modal.importModal.data.title" class="dialogset-title data-input" ng-required="true">
                    </label>
                </div>
                <!--<div class="form-row" style="display: none;">-->
                <!--<label class="required" style="width: 100%;">-->
                <!--<span>Type</span>-->
                <!--<div class="form-box">-->
                <!--<input type="radio" checked="true" ng-model="modal.importModal.data.type" ng-required="true">-->
                <!--<span>(csv or xlsx)</span>-->
                <!--</div>-->
                <!--</label>-->
                <!--</div>-->
                <div class="form-row">
                    <label class="required" style="width: 100%;">
                        <span>File</span>
                        <div class="form-box">
                            <input type="file" nv-file-select uploader="uploader" ng-required="true" />
                        </div>
                    </label>
                </div>
                <div class="form-row">
                    <label style="width: 100%;">
                        <span>{{lan('Content') }}</span>
                        <textarea placeholder="내용을 입력해주세요" name="content" ng-model="modal.importModal.data.content" class="data-input"></textarea>
                    </label>
                </div>
                <div class="tab-footer">
                    <button class="blue-button">{{lan('Save') }}</button>
                    <button type="button" class="default-button" ng-click="modal.importModal.close();">{{lan('Close') }}</button>
                </div>
            </form>
        </div>
    </div>

    <div class="video-popup">
        <div class="video-controller">
            <img src="modules/playchat/log-analysis/client/imgs/logclose.png" ng-click="closeVideo($event);">
        </div>
        <div class="video-wrapper">
            <div class="video-cover" ng-click="openVideoPopup();"></div>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/1epM6DBUypY" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe>
        </div>
        <img src="modules/playchat/working-ground/common/client/imgs/Q.png" style="display:none; cursor: pointer;" ng-click="openVideo($event);">
    </div>

    <div class="modal-background import-modal" ng-show="isOpenVideoPopup" style="background-color: rgba(0, 0, 0, 0.7);">
        <div class="modal" style="width: auto;">
            <iframe width="854" height="480" src="https://www.youtube.com/embed/1epM6DBUypY" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe>
            <div class="tab-footer">
                <button type="button" class="default-button" ng-click="closeVideoPopup();">{{ lan('Close') }}</button>
            </div>
        </div>
    </div>
</div>
